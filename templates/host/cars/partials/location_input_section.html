<!-- templates/host/cars/partials/location_input_section.html -->
<!-- NEW STRUCTURED ADDRESS SECTION -->
<div class="row mb-3">
    <div class="col-12">
        <label class="form-label">Car Location Details *</label>

        <!-- Location Input with Suggestions -->
        <div class="mb-2">
            <label for="addressInput" class="form-label">Search Address (India) *</label>
            <!-- CRITICAL FIX 1: Ensure unique ID and correct structure -->
            <div class="input-group">
                <input type="text" class="form-control" id="addressInput" name="addressInput" placeholder="Start typing address (e.g., Koramangala, Bangalore)..." autocomplete="off">
                <button class="btn btn-outline-secondary" type="button" id="getCurrentLocationBtn">
                    <i class="fas fa-location-arrow"></i>
                </button>
            </div>
            <!-- CRITICAL FIX 1 END -->
            <!-- Suggestions List -->
            <!-- CRITICAL FIX 2: Ensure unique ID and correct positioning -->
            <ul id="suggestionsList" class="list-group position-absolute z-1000 w-100" style="display:none; max-height: 200px; overflow-y: auto; margin-top: 2px;"></ul>
            <!-- CRITICAL FIX 2 END -->
            <div class="form-text">Type to search for an address. Select one from the suggestions.</div>
        </div>

        <!-- Hidden fields for coordinates -->
        <!-- CRITICAL FIX 3: Use consistent, clear IDs -->
        <input type="hidden" id="selected_lat" name="latitude">
        <input type="hidden" id="selected_lng" name="longitude">
        <!-- CRITICAL FIX 3 END -->

        <!-- Structured Address Fields (Auto-filled) -->
        <div class="row">
            <div class="col-md-6 mb-2">
                <label for="street_address" class="form-label">Street Address</label>
                <input type="text" class="form-control" id="street_address" name="street_address">
            </div>
            <div class="col-md-6 mb-2">
                <label for="locality" class="form-label">Locality/Area</label>
                <input type="text" class="form-control" id="locality" name="locality">
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 mb-2">
                <label for="city" class="form-label">City *</label>
                <input type="text" class="form-control" id="city" name="city" required> <!-- Make city required -->
            </div>
            <div class="col-md-4 mb-2">
                <label for="state" class="form-label">State *</label>
                <input type="text" class="form-control" id="state" name="state" required> <!-- Make state required -->
            </div>
            <div class="col-md-4 mb-2">
                <label for="pincode" class="form-label">Pincode</label>
                <input type="text" class="form-control" id="pincode" name="pincode">
            </div>
        </div>

        <!-- Full Address (Hidden or Read-only for confirmation) -->
        <div class="mb-2">
            <label for="full_address" class="form-label">Full Address (Auto-generated)</label>
            <textarea class="form-control" id="full_address" name="full_address" rows="2" readonly></textarea>
        </div>

        <!-- Action Buttons -->
        <div class="d-flex gap-2 mt-2">
            <!-- CRITICAL FIX 4: Ensure button IDs are unique and correct -->
            <button type="button" class="btn btn-outline-primary btn-sm" id="useCurrentLocationBtn">
                <i class="fas fa-map-marker-alt"></i> Use My Location
            </button>
            <button type="button" class="btn btn-outline-secondary btn-sm" id="resetLocationBtn">
                <i class="fas fa-redo"></i> Reset
            </button>
            <!-- CRITICAL FIX 4 END -->
        </div>

        <!-- Validation Message -->
        <div id="locationValidationMessage" class="text-danger mt-2" style="display:none;">
            Please select an address from the suggestions or use 'Use My Location'.
        </div>
    </div>
</div>
<!-- END NEW STRUCTURED ADDRESS SECTION -->
